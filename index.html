<!DOCTYPE html>
<html>
<head>
  <link rel="icon" href='data:image/svg+xml;<svg xmlns="http://w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ðŸ¦ </text></svg>'>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body style="font-family:sans-serif; font-size:18px;">

<h2 id="title" style="color:#ffcccc; width:100%;
    display:block; height:1.2em; overflow:visible;
    background-color:#ffeeee; color: #222; border-radius:.1em; font-weight:normal; 
    padding:0 .2em 0 0;
    " >.</h2>

<div id="app"></div>

<div class="chart" style="display:none; border: 3px solid #669966; margin:1em 0">
<canvas id="myChart" width="400" height="200"></canvas>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js"></script>

<details style="text-align:right; float:right; font-size:.6em; line-height:2em;">

  <summary>Info</summary>

  API for live information about COVID-19
  <br>
  GET https://coronavirus-19-api.herokuapp.com/all -> global info
  <br>
  GET https://coronavirus-19-api.herokuapp.com/countries -> all countries info
  <br>
  GET https://coronavirus-19-api.herokuapp.com/countries/{countryName} -> country specific information
  <br>
  <small><a href="https://github.com/javieraviles/covidAPI">github.com/javieraviles/covidAPI</a></small>
  
</details>

<script>
//let txt = '{"cases":422966,"deaths":18906,"recovered":109143}';

let url = 'https://coronavirus-19-api.herokuapp.com/all';

fetch(url)
  .then((response) => {
    return response.json();
  })
  .then((data) => {
    //console.log(data);
    document.getElementById('app').innerHTML = `
    <small>(recovered+deaths) / cases</small> <br><br>
    ( 
    <b style="color:green">${(data.recovered/1000).toFixed(0)}K</b>
    +
    <b style="
    background-color:#111; color: #eee; border-radius:.1em; font-weight:normal; padding:0 .2em;
    ">${(data.deaths/1000).toFixed(0)}K</b> ) /
    <b style="color:red">${(data.cases/1000).toFixed(0)}K</b> 
    = 
    <b style="
    background-color:#ddd; color: #222; border-radius:.1em; font-weight:normal; padding:0 .2em;
    ">
    ${((data.recovered+data.deaths)/data.cases).toFixed(2)}
    </b>
    `;
  
    document.getElementById('title').innerHTML = `
<div style="width:29%; float:left;
    background-color:#ddd; color: #222; border-radius:.1em; font-weight:normal; 
    padding:0 .2em; margin-right:.2em;
    ">
${(((data.recovered+data.deaths)/data.cases).toFixed(2) * 100).toFixed(0)}%
</div>

<small style="font-size:.5em; line-height:1em; 
float:left; display:block;
margin:.4em 0;
opacity:.75;">
Corona ðŸ¦  loses when <br>
<span style="margin-left:-.5em">
&lsaquo;
<span>
 this reaches 100%
<small>
`
 
  });


// chart.js (manual impt for now)

var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
	// The type of chart we want to create
	type: 'bar', // also try line or other graph types

	// The data for our dataset
	data: {
		labels: ["March 23", "March 24", "March 25", "March 26"],
		// Information about the dataset
    datasets: [{
			label: "Stopped transmitting the virus ",
			backgroundColor: 'ddd',
			borderColor: '669966',
			data: [31, 30, 29, 28],
		}]
	},

	// Configuration options
	options: {
    layout: {
      padding: 10,
    },
		legend: {
			position: 'bottom',
		},
		title: {
			display: true,
			text: 'Corona ðŸ¦  loses when this reaches 100.'
		},
		scales: {
			yAxes: [{
				scaleLabel: {
					display: true,
					labelString: ''
				}
			}],
			xAxes: [{
				scaleLabel: {
					display: true,
					labelString: ''
				}
			}]
		}
	}
});


</script>

</body>
</html>
